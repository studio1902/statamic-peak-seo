title: 'Globals SEO: Trackers - Consent'
fields:
  -
    handle: tracker_type
    field:
      options:
        none: None
        gtag: 'Google Analytics'
        gtm: 'Google Tag Manager'
        scripts: 'Custom scripts'
      default: none
      type: button_group
      instructions: 'The type of tracking you want added on each page.'
      listable: false
      display: 'Tracker type'
      instructions_position: above
      visibility: visible
      always_save: false
  -
    handle: scripts
    field:
      collapse: true
      previews: true
      sets:
        main:
          display: Main
          instructions: null
          icon: null
          sets:
            script:
              display: Script
              instructions: null
              icon: null
              fields:
                -
                  handle: category
                  field:
                    input_type: text
                    antlers: false
                    display: Category
                    type: text
                    icon: text
                    instructions: 'When you use the cookie banner, scripts will be grouped under this category.'
                    listable: hidden
                    instructions_position: above
                    visibility: visible
                    always_save: false
                    localizable: true
                    validate:
                      - required
                      - sometimes
                -
                  handle: explainer
                  field:
                    input_type: text
                    antlers: false
                    display: Explainer
                    type: text
                    icon: text
                    instructions: 'Explainer for the current category when you use the cookie banner.'
                    listable: hidden
                    instructions_position: above
                    visibility: visible
                    validate: required
                    always_save: false
                    localizable: true
                -
                  handle: script_fragments
                  field:
                    mode: stacked
                    min_rows: 1
                    add_row: 'Add script fragment'
                    reorderable: true
                    display: 'Script fragments'
                    type: grid
                    replicator_preview: false
                    icon: grid
                    listable: hidden
                    instructions_position: above
                    visibility: visible
                    always_save: false
                    validate:
                      - required
                      - sometimes
                    fields:
                      -
                        handle: type
                        field:
                          options:
                            script_tag: 'Script tag'
                            inline_script: 'Inline script'
                            body_content: 'Body content'
                          default: script_tag
                          display: Type
                          type: button_group
                          icon: button_group
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                      -
                        handle: source
                        field:
                          input_type: url
                          antlers: false
                          display: Source
                          type: text
                          icon: text
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                          validate:
                            - required
                            - sometimes
                          if:
                            type: 'equals script_tag'
                          instructions: 'The scripts tag `source` attribute. A URL.'
                      -
                        handle: defer
                        field:
                          default: false
                          display: Defer
                          type: toggle
                          icon: toggle
                          width: 50
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                          if:
                            type: 'equals script_tag'
                          instructions: 'If the script tag should be deferred.'
                      -
                        handle: async
                        field:
                          default: false
                          display: Async
                          type: toggle
                          icon: toggle
                          width: 50
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                          if:
                            type: 'equals script_tag'
                          instructions: 'If the script tag should load asynchronous.'
                      -
                        handle: inline_script_attributes
                        field:
                          fields:
                            -
                              handle: attribute
                              field:
                                input_type: text
                                antlers: false
                                type: text
                                display: Attribute
                                icon: text
                                width: 50
                                listable: hidden
                                instructions_position: above
                                visibility: visible
                                replicator_preview: true
                                hide_display: false
                                validate:
                                  - required
                            -
                              handle: attribute_value
                              field:
                                input_type: text
                                antlers: false
                                type: text
                                display: Value
                                icon: text
                                width: 50
                                listable: hidden
                                instructions_position: above
                                visibility: visible
                                replicator_preview: true
                                hide_display: false
                          mode: table
                          add_row: 'Add Attribute'
                          reorderable: true
                          fullscreen: true
                          type: grid
                          display: Attributes
                          icon: grid
                          instructions: 'Add attributes and their values to the `<script>` tag.'
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          replicator_preview: true
                          hide_display: false
                          if:
                            type: 'not body_content'
                      -
                        handle: inline_script
                        field:
                          theme: material
                          mode: javascript
                          mode_selectable: false
                          indent_type: tabs
                          indent_size: 4
                          key_map: default
                          line_numbers: true
                          line_wrapping: true
                          display: 'Inline script'
                          type: code
                          icon: code
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                          if:
                            type: 'equals inline_script'
                          validate:
                            - required
                            - sometimes
                          instructions: 'The inline script tag contents (Javascript). Remove `<script>` and `</script>` tags.'
                      -
                        handle: body_content
                        field:
                          theme: material
                          mode: javascript
                          mode_selectable: false
                          indent_type: tabs
                          indent_size: 4
                          key_map: default
                          line_numbers: true
                          line_wrapping: true
                          display: 'Body content'
                          type: code
                          icon: code
                          listable: hidden
                          instructions_position: above
                          visibility: visible
                          always_save: false
                          if:
                            type: 'equals body_content'
                          validate:
                            - required
                            - sometimes
                          instructions: 'HTML that should be rendered after opening `<body>`.'
                    fullscreen: true
                    hide_display: false
      display: Scripts
      type: replicator
      icon: replicator
      listable: hidden
      instructions_position: above
      visibility: visible
      always_save: false
      localizable: true
      validate:
        - 'required_if:tracker_type,scripts'
      if:
        tracker_type: 'equals scripts'
      replicator_preview: true
      fullscreen: true
      hide_display: false
  -
    handle: google_analytics
    field:
      width: 50
      display: 'Tracking ID'
      input_type: text
      type: text
      listable: hidden
      validate:
        - 'required_if:tracker_type,gtag'
      if:
        tracker_type: 'equals gtag'
  -
    handle: anonymize_ip
    field:
      type: toggle
      width: 50
      listable: false
      default: true
      display: "Anonymize IP's"
      instructions: "Even if you anonymize IP's you need consent according to the GDPR."
      instructions_position: below
      if:
        tracker_type: 'equals gtag'
  -
    handle: google_tag_manager
    field:
      input_type: text
      type: text
      listable: hidden
      width: 50
      display: 'Tracking ID'
      instructions_position: below
      validate:
        - 'required_if:tracker_type,gtm'
      if:
        tracker_type: 'equals gtm'
  -
    handle: use_cookie_banner
    field:
      type: toggle
      instructions: 'Enable the cookie banner. When you use `Google Analytics` or `Google Tag Manager`, make sure you load all tracking scripts via their service as in this case the banner uses the Google Consent API: https://developers.google.com/tag-manager/consent. When you use `Custom scripts`, all your scripts will be injected after consent.'
      instructions_position: below
      listable: false
      display: 'Cookie banner'
  -
    handle: embeds
    field:
      default: false
      display: Embeds
      type: toggle
      icon: toggle
      instructions: "Only load in third party embedded video's from the `video` article set after consent."
      listable: hidden
      instructions_position: below
      visibility: visible
      always_save: false
      if:
        use_cookie_banner: 'equals true'
  -
    handle: hide_by_default
    field:
      default: false
      display: 'Hide by default'
      type: toggle
      icon: toggle
      instructions: "Hide the cookie banner by default. You can use this when you're only using it for video embeds."
      listable: hidden
      instructions_position: below
      visibility: visible
      always_save: false
      if:
        use_cookie_banner: 'equals true'
        embeds: 'equals true'
        tracker_type: 'equals none'
  -
    handle: display_style
    field:
      options:
        left: Left
        right: Right
      default: left
      type: button_group
      listable: false
      localizable: true
      display: 'Display style'
      width: 50
      if:
        use_cookie_banner: 'equals true'
  -
    handle: cookie_revoke_before
    field:
      mode: single
      time_enabled: false
      time_required: false
      earliest_date: '1900-01-01'
      full_width: false
      inline: false
      columns: 1
      rows: 1
      display: 'Revoke consent before'
      instructions: 'Revoke all users consent before this date. Use this when you added new trackers to GTM and your privacy policy changed. The cookie bar will reappear.'
      instructions_position: below
      type: date
      width: 50
      icon: date
      listable: hidden
      use_cookie_banner: 'equals true'
